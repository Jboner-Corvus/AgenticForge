# TODO List: Résoudre les erreurs de vérification

Ce document liste les problèmes identifiés par nos vérifications (TypeCheck, Lint, Test).

La correction de chaque erreur doit se faire **uniquement en modifiant le code source** 

Il est interdit d'exécuter des commandes bash..
Il est interdit de lancer une vérification.

Une fois la correction effectué, cochez la case `[x]`.

---

## Erreurs à corriger

1. [ ] **TypeCheck (Core):** `src/modules/llm/LlmKeyManager.ts(143,43): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

2. [ ] **TypeCheck (Core):** `src/modules/llm/grokProvider.ts(37,9): error TS2353: Object literal may only specify known properties, and 'apiKey' does not exist in type 'LlmApiKey'.`

3. [ ] **TypeCheck (Core):** `src/modules/llm/grokProvider.ts(79,46): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

4. [ ] **TypeCheck (Core):** `src/modules/llm/grokProvider.ts(92,21): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

5. [ ] **TypeCheck (Core):** `src/modules/llm/grokProvider.ts(112,21): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

6. [ ] **TypeCheck (Core):** `src/modules/llm/grokProvider.ts(139,72): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

7. [ ] **TypeCheck (Core):** `src/modules/llm/grokProvider.ts(150,21): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

8. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(95,34): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

9. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(107,21): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

10. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(127,21): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

11. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(154,72): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

12. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(165,21): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

13. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(221,143): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

14. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(279,21): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

15. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(299,21): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

16. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(330,72): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

17. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(342,21): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

18. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(421,46): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

19. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(434,21): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

20. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(454,21): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

21. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(481,72): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

22. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(492,21): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

23. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(533,9): error TS2353: Object literal may only specify known properties, and 'apiKey' does not exist in type 'LlmApiKey'.`

24. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(574,46): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

25. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(587,21): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

26. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(607,21): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

27. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(635,72): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

28. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(647,21): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

29. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(724,46): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

30. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(737,21): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

31. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(757,21): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

32. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(785,72): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

33. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(797,21): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

34. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(838,9): error TS2353: Object literal may only specify known properties, and 'apiKey' does not exist in type 'LlmApiKey'.`

35. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(879,46): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

36. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(892,21): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

37. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(912,21): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

38. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(940,72): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

39. [ ] **TypeCheck (Core):** `src/utils/llmProvider.ts(952,21): error TS2339: Property 'apiKey' does not exist on type 'LlmApiKey'.`

40. [ ] **Test Failure:**
```text
 FAIL  src/webServer.test.ts > webServer
TypeError: Cannot read properties of undefined (reading 'LOG_LEVEL')
 ❯ Module.getLogger src/logger.ts:12:21
     10|     const config = getConfig();
     11|     loggerInstance = pino({
     12|       level: config.LOG_LEVEL || 'debug',
       |                     ^
     13|       ...(config.NODE_ENV === 'development' && {
     14|         transport: {
 ❯ watchConfig src/webServer.ts:710:3
 ❯ Module.initializeWebServer src/webServer.ts:49:5
 ❯ src/webServer.test.ts:45:29

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/32]⎯

```

41. [ ] **Test Failure:**
```text
 FAIL  src/webServer.test.ts > webServer
TypeError: Cannot read properties of undefined (reading 'close')
 ❯ src/webServer.test.ts:56:14
     54|   afterAll(async () => {
     55|     await new Promise<void>((resolve, reject) => {
     56|       server.close((err) => {
       |              ^
     57|         if (err) {
     58|           return reject(err);
 ❯ src/webServer.test.ts:55:11

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/32]⎯

```

42. [ ] **Test Failure:**
```text
 FAIL  src/worker.test.ts [ src/worker.test.ts ]
Error: [vitest] There was an error when mocking a module. If you are using "vi.mock" factory, make sure there are no top level variables inside, since this call is hoisted to top of the file. Read more: https://vitest.dev/api/vi.html#vi-mock
 ❯ src/modules/llm/LlmKeyManager.ts:2:31
      1| import { getLogger } from '../../logger.js';
      2| import { redis as _redis } from '../redis/redisClient.js';
       |                               ^
      3| 
      4| export enum LlmKeyErrorType {
 ❯ src/config.ts:6:31

Caused by: TypeError: Cannot read properties of undefined (reading 'REDIS_HOST')
 ❯ src/modules/redis/redisClient.ts:19:26
 ❯ src/worker.test.ts:3:18
 ❯ src/modules/llm/LlmKeyManager.ts:2:31

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/32]⎯

```

43. [ ] **Test Failure:**
```text
 FAIL  src/utils/errorUtils.test.ts [ src/utils/errorUtils.test.ts ]
```

44. [ ] **Test Failure:**
```text
 FAIL  src/utils/validationUtils.test.ts [ src/utils/validationUtils.test.ts ]
```

45. [ ] **Test Failure:**
```text
 FAIL  src/modules/tools/toolRegistry.test.ts [ src/modules/tools/toolRegistry.test.ts ]
```

46. [ ] **Test Failure:**
```text
 FAIL  src/modules/tools/definitions/fs/editFile.tool.test.ts [ src/modules/tools/definitions/fs/editFile.tool.test.ts ]
```

47. [ ] **Test Failure:**
```text
 FAIL  src/modules/tools/definitions/fs/listDirectory.tool.test.ts [ src/modules/tools/definitions/fs/listDirectory.tool.test.ts ]
```

48. [ ] **Test Failure:**
```text
 FAIL  src/modules/tools/definitions/fs/readFile.tool.test.ts [ src/modules/tools/definitions/fs/readFile.tool.test.ts ]
```

49. [ ] **Test Failure:**
```text
 FAIL  src/modules/tools/definitions/system/finish.tool.test.ts [ src/modules/tools/definitions/system/finish.tool.test.ts ]
TypeError: Cannot read properties of undefined (reading 'REDIS_HOST')
 ❯ src/modules/redis/redisClient.ts:19:26
     17| // Si le worker est local (pas dans Docker), il doit utiliser 'localho…
     18| // Si le worker est dans Docker, il doit utiliser le nom de service 'r…
     19| const redisHost = config.REDIS_HOST;
       |                          ^
     20| const redisUrl = `redis://${redisHost}:${config.REDIS_PORT}`;
     21| 
 ❯ src/modules/llm/LlmKeyManager.ts:2:31

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/32]⎯

```

50. [ ] **Test Failure:**
```text
 FAIL  src/modules/tools/definitions/fs/writeFile.tool.test.ts [ src/modules/tools/definitions/fs/writeFile.tool.test.ts ]
TypeError: getLogger is not a function
 ❯ src/modules/tools/definitions/fs/writeFile.tool.test.ts:45:10
     43|   const mockCtx: Ctx = {
     44|     llm: {} as ILlmProvider,
     45|     log: getLogger(),
       |          ^
     46|     reportProgress: vi.fn(),
     47|     session: {} as SessionData,

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/32]⎯

```

51. [ ] **Test Failure:**
```text
 FAIL  src/modules/tools/definitions/system/agentResponse.tool.test.ts [ src/modules/tools/definitions/system/agentResponse.tool.test.ts ]
TypeError: getLogger is not a function
 ❯ src/modules/tools/definitions/system/agentResponse.tool.test.ts:23:10
     21|   const mockCtx: Ctx = {
     22|     llm: {} as ILlmProvider,
     23|     log: getLogger(),
       |          ^
     24|     reportProgress: vi.fn(),
     25|     session: {} as SessionData,

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/32]⎯

```

52. [ ] **Test Failure:**
```text
 FAIL  src/modules/tools/definitions/system/listTools.tool.test.ts [ src/modules/tools/definitions/system/listTools.tool.test.ts ]
Error: [vitest] There was an error when mocking a module. If you are using "vi.mock" factory, make sure there are no top level variables inside, since this call is hoisted to top of the file. Read more: https://vitest.dev/api/vi.html#vi-mock
 ❯ src/modules/tools/definitions/system/listTools.tool.test.ts:16:25
     14| 
     15| vi.mock('../../../../logger.js', async () => {
     16|   const actual = await vi.importActual<typeof import('../../../../logg…
       |                         ^
     17|     '../../../../logger.js',
     18|   );

Caused by: TypeError: Cannot read properties of undefined (reading 'REDIS_HOST')
 ❯ src/modules/redis/redisClient.ts:19:26
 ❯ src/modules/llm/LlmKeyManager.ts:2:31

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/32]⎯

```

53. [ ] **Test Failure:**
```text
 FAIL  src/modules/tools/definitions/web/browser.tool.test.ts [ src/modules/tools/definitions/web/browser.tool.test.ts ]
TypeError: getLogger is not a function
 ❯ src/modules/tools/definitions/web/browser.tool.test.ts:36:10
     34|   const mockCtx: Ctx = {
     35|     llm: {} as ILlmProvider,
     36|     log: getLogger(),
       |          ^
     37|     reportProgress: vi.fn(),
     38|     session: {} as SessionData,

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/32]⎯

⎯⎯⎯⎯⎯⎯ Failed Tests 18 ⎯⎯⎯⎯⎯⎯⎯

```

54. [ ] **Test Failure:**
```text
 FAIL  src/logger.test.ts > Logger > should instantiate a pino logger with debug level
AssertionError: expected "spy" to be called with arguments: [ ObjectContaining {"level": "debug"} ]

Received: 



Number of calls: 0

 ❯ src/logger.test.ts:41:22
     39|     // Re-import logger.js to ensure it picks up the mock
     40|     await import('./logger.ts');
     41|     expect(pinoMock).toHaveBeenCalledWith(
       |                      ^
     42|       expect.objectContaining({
     43|         level: 'debug',

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/32]⎯

```

55. [ ] **Test Failure:**
```text
 FAIL  src/logger.test.ts > Logger > should set the log level based on LOG_LEVEL environment variable
Error: [vitest] No "getConfig" export is defined on the "./config.js" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

vi.mock("./config.js", async (importOriginal) => {
  const actual = await importOriginal()
  return {
    ...actual,
    // your mocked methods
  }
})

 ❯ getLogger src/logger.ts:10:20
      8| export function getLogger(): Logger {
      9|   if (!loggerInstance) {
     10|     const config = getConfig();
       |                    ^
     11|     loggerInstance = pino({
     12|       level: config.LOG_LEVEL || 'debug',
 ❯ src/logger.test.ts:58:12

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/32]⎯

```

56. [ ] **Test Failure:**
```text
 FAIL  src/logger.test.ts > Logger > should configure pino-pretty transport in development environment
AssertionError: expected "spy" to be called with arguments: [ ObjectContaining{…} ]

Received: 



Number of calls: 0

 ❯ src/logger.test.ts:72:22
     70|     await import('./logger.ts');
     71| 
     72|     expect(pinoMock).toHaveBeenCalledWith(
       |                      ^
     73|       expect.objectContaining({
     74|         level: 'debug',

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/32]⎯

```

57. [ ] **Test Failure:**
```text
 FAIL  src/logger.test.ts > Logger > should not configure pino-pretty transport in non-development environment
AssertionError: expected "spy" to be called with arguments: [ ObjectContaining {"level": "debug"} ]

Received: 



Number of calls: 0

 ❯ src/logger.test.ts:99:22
     97|     await import('./logger.ts');
     98| 
     99|     expect(pinoMock).toHaveBeenCalledWith(
       |                      ^
    100|       expect.objectContaining({
    101|         level: 'debug',

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/32]⎯

```

58. [ ] **Test Failure:**
```text
 FAIL  src/utils/toolLoader.test.ts > toolLoader > should discover and load tool files correctly
Error: [vitest] No "getLogger" export is defined on the "../logger" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

vi.mock("../logger", async (importOriginal) => {
  const actual = await importOriginal()
  return {
    ...actual,
    // your mocked methods
  }
})

 ❯ Module.getToolsDir src/utils/toolLoader.ts:96:3
     94| // Fonction pour obtenir dynamiquement le répertoire des outils
     95| export function getToolsDir(): string {
     96|   getLogger().debug(`[getToolsDir] Running in dist: ${runningInDist}`);
       |   ^
     97|   getLogger().debug(`[getToolsDir] __dirname: ${__dirname}`);
     98|   const toolsPath =
 ❯ src/utils/toolLoader.test.ts:87:25

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/32]⎯

```

59. [ ] **Test Failure:**
```text
 FAIL  src/utils/toolLoader.test.ts > toolLoader > should handle errors during file loading gracefully
Error: [vitest] No "getLogger" export is defined on the "../logger" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

vi.mock("../logger", async (importOriginal) => {
  const actual = await importOriginal()
  return {
    ...actual,
    // your mocked methods
  }
})

 ❯ Module.getToolsDir src/utils/toolLoader.ts:96:3
     94| // Fonction pour obtenir dynamiquement le répertoire des outils
     95| export function getToolsDir(): string {
     96|   getLogger().debug(`[getToolsDir] Running in dist: ${runningInDist}`);
       |   ^
     97|   getLogger().debug(`[getToolsDir] __dirname: ${__dirname}`);
     98|   const toolsPath =
 ❯ src/utils/toolLoader.test.ts:139:25

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/32]⎯

```

60. [ ] **Test Failure:**
```text
 FAIL  src/utils/toolLoader.test.ts > toolLoader > should not register invalid tools
Error: [vitest] No "getLogger" export is defined on the "../logger" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

vi.mock("../logger", async (importOriginal) => {
  const actual = await importOriginal()
  return {
    ...actual,
    // your mocked methods
  }
})

 ❯ Module.getToolsDir src/utils/toolLoader.ts:96:3
     94| // Fonction pour obtenir dynamiquement le répertoire des outils
     95| export function getToolsDir(): string {
     96|   getLogger().debug(`[getToolsDir] Running in dist: ${runningInDist}`);
       |   ^
     97|   getLogger().debug(`[getToolsDir] __dirname: ${__dirname}`);
     98|   const toolsPath =
 ❯ src/utils/toolLoader.test.ts:161:25

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/32]⎯

```

61. [ ] **Test Failure:**
```text
 FAIL  src/modules/queue/queue.test.ts > Queue Initialization and Error Handling > should log an error when jobQueue emits an error
AssertionError: expected "spy" to be called with arguments: [ { …(1) }, 'Job queue error' ]

Received: 



Number of calls: 0

 ❯ src/modules/queue/queue.test.ts:52:31
     50|     const testError = new Error('Job queue test error');
     51|     jobQueue.emit('error', testError);
     52|     expect(getLogger().error).toHaveBeenCalledWith(
       |                               ^
     53|       { err: testError },
     54|       'Job queue error',

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/32]⎯

```

62. [ ] **Test Failure:**
```text
 FAIL  src/modules/queue/queue.test.ts > Queue Initialization and Error Handling > should log an error when deadLetterQueue emits an error
AssertionError: expected "spy" to be called with arguments: [ { …(1) }, 'Dead-letter queue error' ]

Received: 



Number of calls: 0

 ❯ src/modules/queue/queue.test.ts:61:31
     59|     const testError = new Error('Dead-letter queue test error');
     60|     deadLetterQueue.emit('error', testError);
     61|     expect(getLogger().error).toHaveBeenCalledWith(
       |                               ^
     62|       { err: testError },
     63|       'Dead-letter queue error',

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/32]⎯

```

63. [ ] **Test Failure:**
```text
 FAIL  src/modules/session/sessionManager.test.ts > SessionManager > should create a new session if one does not exist in the database
Error: [vitest] No "getConfig" export is defined on the "../../config" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

vi.mock("../../config", async (importOriginal) => {
  const actual = await importOriginal()
  return {
    ...actual,
    // your mocked methods
  }
})

 ❯ Module.getLogger src/logger.ts:10:20
      8| export function getLogger(): Logger {
      9|   if (!loggerInstance) {
     10|     const config = getConfig();
       |                    ^
     11|     loggerInstance = pino({
     12|       level: config.LOG_LEVEL || 'debug',
 ❯ SessionManager.getSession src/modules/session/sessionManager.ts:182:7
 ❯ src/modules/session/sessionManager.test.ts:66:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/32]⎯

```

64. [ ] **Test Failure:**
```text
 FAIL  src/modules/session/sessionManager.test.ts > SessionManager > should load an existing session from the database
Error: [vitest] No "getConfig" export is defined on the "../../config" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

vi.mock("../../config", async (importOriginal) => {
  const actual = await importOriginal()
  return {
    ...actual,
    // your mocked methods
  }
})

 ❯ Module.getLogger src/logger.ts:10:20
      8| export function getLogger(): Logger {
      9|   if (!loggerInstance) {
     10|     const config = getConfig();
       |                    ^
     11|     loggerInstance = pino({
     12|       level: config.LOG_LEVEL || 'debug',
 ❯ SessionManager.getSession src/modules/session/sessionManager.ts:204:5
 ❯ src/modules/session/sessionManager.test.ts:85:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/32]⎯

```

65. [ ] **Test Failure:**
```text
 FAIL  src/modules/session/sessionManager.test.ts > SessionManager > should save a session to the database
Error: [vitest] No "getConfig" export is defined on the "../../config" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

vi.mock("../../config", async (importOriginal) => {
  const actual = await importOriginal()
  return {
    ...actual,
    // your mocked methods
  }
})

 ❯ Module.getLogger src/logger.ts:10:20
      8| export function getLogger(): Logger {
      9|   if (!loggerInstance) {
     10|     const config = getConfig();
       |                    ^
     11|     loggerInstance = pino({
     12|       level: config.LOG_LEVEL || 'debug',
 ❯ SessionManager.saveSession src/modules/session/sessionManager.ts:260:7
 ❯ src/modules/session/sessionManager.test.ts:104:5

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/32]⎯

```

66. [ ] **Test Failure:**
```text
 FAIL  src/modules/session/sessionManager.test.ts > SessionManager > should summarize history if it exceeds HISTORY_MAX_LENGTH
Error: [vitest] No "getConfig" export is defined on the "../../config" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

vi.mock("../../config", async (importOriginal) => {
  const actual = await importOriginal()
  return {
    ...actual,
    // your mocked methods
  }
})

 ❯ Module.getLogger src/logger.ts:10:20
      8| export function getLogger(): Logger {
      9|   if (!loggerInstance) {
     10|     const config = getConfig();
       |                    ^
     11|     loggerInstance = pino({
     12|       level: config.LOG_LEVEL || 'debug',
 ❯ SessionManager.saveSession src/modules/session/sessionManager.ts:260:7
 ❯ src/modules/session/sessionManager.test.ts:137:5

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/32]⎯

```

67. [ ] **Test Failure:**
```text
 FAIL  src/modules/session/sessionManager.test.ts > SessionManager > should delete a session from the database
Error: [vitest] No "getConfig" export is defined on the "../../config" mock. Did you forget to return it from "vi.mock"?
If you need to partially mock a module, you can use "importOriginal" helper inside:

vi.mock("../../config", async (importOriginal) => {
  const actual = await importOriginal()
  return {
    ...actual,
    // your mocked methods
  }
})

 ❯ Module.getLogger src/logger.ts:10:20
      8| export function getLogger(): Logger {
      9|   if (!loggerInstance) {
     10|     const config = getConfig();
       |                    ^
     11|     loggerInstance = pino({
     12|       level: config.LOG_LEVEL || 'debug',
 ❯ SessionManager.deleteSession src/modules/session/sessionManager.ts:124:5
 ❯ src/modules/session/sessionManager.test.ts:149:5

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/32]⎯

```

68. [ ] **Test Failure:**
```text
 FAIL  src/modules/tools/definitions/search/webSearch.tool.test.ts > webSearchTool > should perform a web search and return a summary
```

69. [ ] **Test Failure:**
```text
 FAIL  src/modules/tools/definitions/search/webSearch.tool.test.ts > webSearchTool > should return a message if no direct answer is found
```

70. [ ] **Test Failure:**
```text
 FAIL  src/modules/tools/definitions/search/webSearch.tool.test.ts > webSearchTool > should return an error message if fetch request fails
```

71. [ ] **Test Failure:**
```text
 FAIL  src/modules/tools/definitions/search/webSearch.tool.test.ts > webSearchTool > should return an error message if the fetch call throws an exception
TypeError: getLogger is not a function
 ❯ src/modules/tools/definitions/search/webSearch.tool.test.ts:30:12
     28|       },
     29|       llm: {} as ILlmProvider,
     30|       log: getLogger(),
       |            ^
     31|       reportProgress: vi.fn(),
     32|       session: {} as SessionData,

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/32]⎯

## Erreurs non gérées (Unhandled Errors)

1. [ ] **Unhandled Rejection:** `Error: [vitest] No "getConfig" export is defined on the "../../config" mock. (Originated in src/modules/session/sessionManager.test.ts)`
2. [ ] **Unhandled Rejection:** `Error: [vitest] No "getConfig" export is defined on the "../../config" mock. (Originated in src/modules/session/sessionManager.test.ts)`
3. [ ] **Unhandled Rejection:** `Error: [vitest] No "getConfig" export is defined on the "../../config" mock. (Originated in src/modules/session/sessionManager.test.ts)`
4. [ ] **Unhandled Rejection:** `Error: [vitest] No "getConfig" export is defined on the "../../config" mock. (Originated in src/modules/session/sessionManager.test.ts)`
5. [ ] **Unhandled Rejection:** `Error: [vitest] No "getConfig" export is defined on the "../../config" mock. (Originated in src/modules/session/sessionManager.test.ts)`
6. [ ] **Unhandled Rejection:** `Error: [vitest] No "getConfig" export is defined on the "../../config" mock. (Originated in src/modules/session/sessionManager.test.ts)`

---

✗ 2 type(s) de vérification ont échoué : TypeCheck Core Tests.
Veuillez consulter le fichier all-checks.md pour les 71 erreur(s) détaillée(s).

